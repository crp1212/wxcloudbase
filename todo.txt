数据交互模式
第一步、
1. 客户端进入，携带信息： 身份、房间号
2. 服务端接收，确认房间、发送房间历史数据
3. 客户端接收历史数据，渲染当前实时态

第二步、
1. 客户端发送操作，服务器接收，记录当前操作数据，广播给房间内其他人
2. 客户端接收到信息，显示接收到的信息

消息数据结构
{
  type: 'init', // 初始化
  guid: '', // 用户唯一id
}

{
  type: 'history', // 历史信息
  data: [] // 历史信息数组
}

{
  type: 'step', // 步骤，代表已每一步操作
  from: 'user', // 系统或者用户
  data: 0, // 翻开索引
}



我想使用nodejs的express-ws库搭建一个多人在线聊天的功能，需要实现的功能要点有
1. 存在用户进入不同房间的概念，不同房间的消息和历史记录不共享
2. 用户进入房间里会先得到房间的历史记录信息
3. 用户在房间里可以进行发言，发言会传递到通房间里的其他用户，并会记录这个信息
4. 房间里不存在用户后，5分钟内会清除该房间信息，释放缓存

客户端是微信小程序或者h5，务必要考虑这一点
请为我编写这样一份功能代码
